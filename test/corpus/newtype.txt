=========================================
newtype: basic
=========================================

newtype A = A A

---

(module
 (newtype
  (type)
  (equals)
  (constr_newtype (constr_id (constructor)) (type_name (type)))))

=========================================
newtype: context
=========================================

newtype A a => A a = A a

---

(module
 (newtype
  (context (constraint (class_name (type)) (type_name (tyvar))) (carrow))
  (type)
  (tyvar)
  (equals)
  (constr_newtype (constr_id (constructor)) (type_name (tyvar)))))

=========================================
newtype: record
=========================================

newtype A = A { a :: A a }

---

(module
 (newtype
  (type)
  (equals)
  (constr_newtype
   (constr_id (constructor))
   (field (field_id (variable)) (annotation) (type_apply (type_name (type)) (type_name (tyvar)))))))

=========================================
newtype: tyvar kind
=========================================

newtype A a (a :: [* -> *]) a =
  A a

---

(module
 (newtype
  (type)
  (tyvar)
  (annotated_tyvar
   (tyvar)
   (annotation)
   (list_type (fun (star) (star))))
  (tyvar)
  (equals)
  (constr_newtype (constr_id (constructor)) (type_name (tyvar)))))

=========================================
newtype: deriving
=========================================

newtype A = A a deriving A
newtype A a =
  A { a :: A }
  deriving (A, A)
  deriving newtype A
  deriving A via (A a)

---

(module
 (newtype
  (type)
  (equals)
  (constr_newtype (constr_id (constructor)) (type_name (tyvar)))
  (deriving (type)))
 (newtype
  (type)
  (tyvar)
  (equals)
  (constr_newtype (constr_id (constructor)) (field (field_id (variable)) (annotation) (type_name (type))))
  (deriving (type) (comma) (type))
  (deriving (type))
  (deriving (type) (via (type_parens (type_apply (type_name (type)) (type_name (tyvar))))))))
