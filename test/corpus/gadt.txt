=========================================
gadt: empty
=========================================

data A where

---

(module (adt (type) (where)))

=========================================
gadt: basic
=========================================

data A a where
  A :: A -> !(A a) ->
    A a
  A :: {-# unpack #-} A -> A a

---

(module
 (adt
  (type)
  (type_variable)
  (where)
  (gadt_constr
   (constructor)
   (fun
    (type_name (type))
    (fun
     (strict_type (type_parens (type_apply (type_name (type)) (type_name (type_variable)))))
     (type_apply (type_name (type)) (type_name (type_variable))))))
  (gadt_constr
   (constructor)
   (pragma)
   (fun
    (type_name (type))
    (type_apply (type_name (type)) (type_name (type_variable)))))))

=========================================
gadt: record
=========================================

data A where
  A :: { a :: A, a :: !A } -> A

---

(module
 (adt
  (type)
  (where)
  (gadt_constr
   (constructor)
   (record_fields
    (field (field_id (variable)) (type_name (type)))
    (comma)
    (field (field_id (variable)) (strict_type (type_name (type)))))
   (type_name (type)))))

=========================================
gadt: signature
=========================================

data A :: [*] -> * where

---

(module
 (adt
  (type)
  (fun
   (list_type (type_star))
   (type_star))
  (where)))

=========================================
gadt: context
=========================================

data A a => A where

---

(module
 (adt
  (context (constraint (class_name (type)) (type_name (type_variable))))
  (type)
  (where)))

=========================================
gadt: con context
=========================================

data A where
  A :: A a => A

---

(module
 (adt
  (type)
  (where)
  (gadt_constr
   (constructor)
   (context
    (constraint (class_name (type)) (type_name (type_variable)))
   )
   (type_name (type)))))

=========================================
gadt: forall
=========================================

data A where
  A :: âˆ€ a . A

---

(module
 (adt
  (type)
  (where)
  (gadt_constr
   (constructor)
   (forall (type_variable) (forall_dot))
   (type_name (type)))))

=========================================
gadt: deriving
=========================================

data A where
  A :: A
  deriving A

---

(module
 (adt
  (type)
  (where)
  (gadt_constr (constructor) (type_name (type)))
  (deriving (type))))

=========================================
gadt: symbolic
=========================================

data a +++ b where
  (:+++) :: a -> b -> a +++ b

---

(module
 (adt
  (type_infix (type_variable) (type_operator) (type_variable))
  (where)
  (gadt_constr
   (consym)
   (fun
    (type_name (type_variable))
    (fun
     (type_name (type_variable))
     (type_infix
      (type_name (type_variable))
      (tyconop (type_operator))
      (type_name (type_variable))))))))
